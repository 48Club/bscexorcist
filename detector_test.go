package bscexorcist

import (
	"testing"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/common/hexutil"
	"github.com/ethereum/go-ethereum/core/types"
)

func TestDetectSandwichForBundle(t *testing.T) {
	tests := []struct {
		name    string
		logs    [][]*types.Log
		wantErr bool
	}{
		{
			name:    "testCase1",
			logs:    testCase1,
			wantErr: true,
		},
		{
			name:    "testCase2",
			logs:    testCase2,
			wantErr: true,
		},
		{
			name:    "testCase3",
			logs:    testCase3,
			wantErr: true,
		},
		{
			name:    "testCase4",
			logs:    testCase4,
			wantErr: true,
		},
		{
			name:    "testCase5",
			logs:    testCase5,
			wantErr: true,
		},
		{
			name:    "testCase6DODO",
			logs:    testCase6DODO,
			wantErr: true,
		},
		{
			name:    "testCase0",
			logs:    testCase0,
			wantErr: true,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			if err := DetectSandwichForBundle(tt.logs); (err != nil) != tt.wantErr {
				t.Errorf("DetectSandwichForBundle() error = %v, wantErr %v", err, tt.wantErr)
			}
		})
	}
}

var (
	testCase0 = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0x5F4D3c0538cAf488053AaE0341f5A4A207F7Ff8e"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0x0000000000000000000000002104ba06a100d8cb1a3985237842d5647c157ab8"),
					common.HexToHash("0x0000000000000000000000002104ba06a100d8cb1a3985237842d5647c157ab8"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a38ea878535194ec0000000000000000000000000000000000000000000000aad7ffa9942a5d1c880000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0x5F4D3c0538cAf488053AaE0341f5A4A207F7Ff8e"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0x000000000000000000000000d9c500dff816a1da21a48a732d3498bf09dc9aeb"),
					common.HexToHash("0x000000000000000000000000c7e53484f23333b722d47cc58e93f86806db6220"),
				},
				Data: hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003d1e994fc5cfcdff3e00000000000000000000000000000000000000000000152d02c7e14af68000190000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0x5F4D3c0538cAf488053AaE0341f5A4A207F7Ff8e"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0x0000000000000000000000002104ba06a100d8cb1a3985237842d5647c157ab8"),
					common.HexToHash("0x0000000000000000000000002104ba06a100d8cb1a3985237842d5647c157ab8"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000000000aad7ffa9942a5d1c870000000000000000000000000000000000000000000000aad7ffa9942a5d1c8800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aca5d502e51879a5bd"),
			},
		},
	}

	testCase1 = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0xE21d99B42ECCbb7eA0e185f561B0a80fE1FC4d1C"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000000000000000000000000001a2241a49c6b6245af000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010d978570f31444e0ce7"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0xE21d99B42ECCbb7eA0e185f561B0a80fE1FC4d1C"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000000000000000000000000000acf3b1b8894e40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006dedd5cc45eb0799505"),
			},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0xE21d99B42ECCbb7eA0e185f561B0a80fE1FC4d1C"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000058f71f3c5037542b775000000000000000000000000000000000000000000000008b621b4b388f9b2590000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx4
		{
			{
				Address: common.HexToAddress("0xE21d99B42ECCbb7eA0e185f561B0a80fE1FC4d1C"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b4a06634a2dcf0b5572000000000000000000000000000000000000000000000011823e3b2b071b29270000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
	}

	testCase2 = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0x8BC4BE4d483d1B3EA5Bf7D5a392A3b4bD9A874A9"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b8807aba155303280000000000000000000000000000000000000000002b58249b01a661c0bcd08c0000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0x8BC4BE4d483d1B3EA5Bf7D5a392A3b4bD9A874A9"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000000000000000000000002fca1f25b3dba8d6764410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011f852d27d9ffa52"),
			},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0x8BC4BE4d483d1B3EA5Bf7D5a392A3b4bD9A874A9"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006de97e09bd1800000000000000000000000000000000000000000000000fb17f35d5ccd60f325f5e0000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx4
		{
			{
				Address: common.HexToAddress("0x8BC4BE4d483d1B3EA5Bf7D5a392A3b4bD9A874A9"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000001156750acd75c0b37eb9d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076d82e76d8bdbca2"),
			},
		},
		// tx5
		{
			{
				Address: common.HexToAddress("0x8BC4BE4d483d1B3EA5Bf7D5a392A3b4bD9A874A9"),
				Topics: []common.Hash{
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
					common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000001a01af903430a10d3e16ba0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000073f8036b326e0c03"),
			},
		},
	}

	testCase3 = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0x9Ae10A97634Ff4Cff2397D35DDD7f62C2446667D"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
				},
				Data: hexutil.MustDecode("0xfffffffffffffffffffffffffffffffffffffffffffff32c5190561236a289a00000000000000000000000000000000000000000000000000d133dbb20f49e85000000000000000000000000000000000000000001031a64b244a9110948bbe0000000000000000000000000000000000000000000000a10991d832477b35a73fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe4fb3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c4709ca0c20"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0x9Ae10A97634Ff4Cff2397D35DDD7f62C2446667D"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
				},
				Data: hexutil.MustDecode("0xfffffffffffffffffffffffffffffffffffffffffffffec80c99f25d775f4984000000000000000000000000000000000000000000000000013fbe85edc90000000000000000000000000000000000000000000001033a289b1564a5e06e79f1000000000000000000000000000000000000000000000a10991d832477b35a73fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe4fbd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002b381cb8400"),
			},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0x9Ae10A97634Ff4Cff2397D35DDD7f62C2446667D"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000000007b2357632c1df3813d2fffffffffffffffffffffffffffffffffffffffffffffffff82218dadfb22c48000000000000000000000000000000000000000001027210cec6e24142da238c000000000000000000000000000000000000000000000a10991d832477b35a73fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe4f8100000000000000000000000000000000000000000000000010a4f26ee3c5117f0000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx4
		{
			{
				Address: common.HexToAddress("0x9Ae10A97634Ff4Cff2397D35DDD7f62C2446667D"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000000000000000000000000052178f9772bea25628bfffffffffffffffffffffffffffffffffffffffffffffffffac821a82c62031a00000000000000000000000000000000000000000101ed56dfbb168c2a220ce7000000000000000000000000000000000000000000000a10991d832477b35a73fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe4f580000000000000000000000000000000000000000000000000b18a19f428360ff0000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
	}

	testCase4 = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0xb6Bb744FB59fa399D09f67Ae3634942F533B577f"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x00000000000000000000000000000000c5d17f1bb0245b5eb1cf27c28115996e"),
					common.HexToHash("0x00000000000000000000000000000000c5d17f1bb0245b5eb1cf27c28115996e"),
				},
				Data: hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffffff260af37100191b240000000000000000000000000000000000000000000000024b272c4a030060000000000000000000000000000000000000000001a4f8d670605487c25e5848ae0000000000000000000000000000000000000000000001127b950b545353219f00000000000000000000000000000000000000000000000000000000000026dc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000180cbee2ac519"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0xb6Bb744FB59fa399D09f67Ae3634942F533B577f"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x0000000000000000000000000f4a1d7fdf4890be35e71f3e0bbc4a0ec377eca3"),
					common.HexToHash("0x0000000000000000000000000f4a1d7fdf4890be35e71f3e0bbc4a0ec377eca3"),
				},
				Data: hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffffffe34853336dfc15ef0000000000000000000000000000000000000000000000004db73254763000000000000000000000000000000000000000000001a541501ac1e373df9a4cab350000000000000000000000000000000000000000000001127b950b545353219f00000000000000000000000000000000000000000000000000000000000026e90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032ee841b8000"),
			},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0xb6Bb744FB59fa399D09f67Ae3634942F533B577f"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x00000000000000000000000000000000c5d17f1bb0245b5eb1cf27c28115996e"),
					common.HexToHash("0x00000000000000000000000000000000c5d17f1bb0245b5eb1cf27c28115996e"),
				},
				Data: hexutil.MustDecode("0x000000000000000000000000000000000000000000000000d9f50c8effe6e4dcfffffffffffffffffffffffffffffffffffffffffffffffdb4734e6942e114920000000000000000000000000000000000000001a3c40f235663b5146d9e256c00000000000000000000000000000000000000000000033610b8541f16501c5e00000000000000000000000000000000000000000000000000000000000026a200000000000000000000000000000000000000000000000000008ed7277121990000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
	}

	testCase5 = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0xcF59B8C8BAA2dea520e3D549F97d4e49aDE17057"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x000000000000000000000000b5cb0555c0c51e603ead62c6437da65372e4e1b0"),
					common.HexToHash("0x000000000000000000000000b5cb0555c0c51e603ead62c6437da65372e4e1b0"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000000000000000000000000457023c6a77de0f332d2ffffffffffffffffffffffffffffffffffffffffffffffc9e4ee9e3f80a2abde0000000000000000000000000000000000000000001f3d7fa22fbeaa5c1d89e2000000000000000000000000000000000000000000000006e27bd7319038a46bfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffdaa6b000000000000000000000000000000000000000000000000962c3e7ee2365c120000000000000000000000000000000000000000000000000000000000000000"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF"),
				Topics: []common.Hash{
					common.HexToHash("0x40e9cecb9f5f1f1c5b9c97dec2917b7ee92e57ba5563708daca94dd84ad7112f"),
					common.HexToHash("0xc012e144f83cd4c616704b5391205ad0dc19719ca9f89b739a67a9b1d5316f17"),
					common.HexToHash("0x000000000000000000000000c0fab674ff7ddf8b891495ba9975b0fe1dcac735"),
				},
				Data: hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffe76eefee5f2095db0800000000000000000000000000000000000000000000000063030b852e1e7ba6300000000000000000000000000000000000000000201e4fb7bb2dc5c7940e7e13000000000000000000000000000000000000000000392bbff455b2bb9dafab33ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff5dd2000000000000000000000000000000000000000000000000000000000000000a"),
			}, {
			Address: common.HexToAddress("0xcF59B8C8BAA2dea520e3D549F97d4e49aDE17057"),
			Topics: []common.Hash{
				common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
				common.HexToHash("0x0000000000000000000000007a7ad9aa93cd0a2d0255326e5fb145cec14997ff"),
				common.HexToHash("0x000000000000000000000000927c4306a908362694eece7e4f45c1624dd51721"),
			},
			Data: hexutil.MustDecode("0x000000000000000000000000000000000000000000000a0235f4380f2b3e7800ffffffffffffffffffffffffffffffffffffffffffffffffffdf98888f57ad3a0000000000000000000000000000000000000000001a8895ed39cbb97d40ba1b000000000000000000000000000000000000000000000006e27bd7319038a46bfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd9da900000000000000000000000000000000000000000000000015a543308721dedd0000000000000000000000000000000000000000000000000000000000000000"),
		}, {
			Address: common.HexToAddress("0x81C7294b66955824BC04acB642ae8dC58e6cE507"),
			Topics: []common.Hash{
				common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
				common.HexToHash("0x0000000000000000000000007a7ad9aa93cd0a2d0255326e5fb145cec14997ff"),
				common.HexToHash("0x000000000000000000000000927c4306a908362694eece7e4f45c1624dd51721"),
			},
			Data: hexutil.MustDecode("0x0000000000000000000000000000000000000000000009194852618227501000ffffffffffffffffffffffffffffffffffffffffffffffdb7dc39bf9b68a3d1400000000000000000000000000000000000000001ec15609a9c3c315b47cc4390000000000000000000000000000000000000000000002181e7c4540269d76a3ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff5a6f"),
		}, {
			Address: common.HexToAddress("0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF"),
			Topics: []common.Hash{
				common.HexToHash("0x40e9cecb9f5f1f1c5b9c97dec2917b7ee92e57ba5563708daca94dd84ad7112f"),
				common.HexToHash("0xb2008c0126f1adeed67d42da44ac4b5c5abd9ef156bd93c106e082cb10e04552"),
				common.HexToHash("0x000000000000000000000000c0fab674ff7ddf8b891495ba9975b0fe1dcac735"),
			},
			Data: hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffff712f87ca2fadd49f5f0000000000000000000000000000000000000000000000023f8adb35e075df3900000000000000000000000000000000000000000000000000000001000276a40000000000000000000000000000000000000000000000000000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffff276180000000000000000000000000000000000000000000000000000000000000008"),
		}, {
			Address: common.HexToAddress("0x28e2Ea090877bF75740558f6BFB36A5ffeE9e9dF"),
			Topics: []common.Hash{
				common.HexToHash("0x40e9cecb9f5f1f1c5b9c97dec2917b7ee92e57ba5563708daca94dd84ad7112f"),
				common.HexToHash("0xed461e6026d36fa5c289a288cc450fb7556ad2e2642fcda0d173a284140d96bd"),
				common.HexToHash("0x000000000000000000000000c0fab674ff7ddf8b891495ba9975b0fe1dcac735"),
			},
			Data: hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffff17125e2972fc1198000000000000000000000000000000000000000000000000005a740cfe34ef868d000000000000000000000000000000000000000000006c756dcfcc1d9835b57e00000000000000000000000000000000000000000000000000592f0d2b1cd66dfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc5a6c0000000000000000000000000000000000000000000000000000000000000005"),
		},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0xcF59B8C8BAA2dea520e3D549F97d4e49aDE17057"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x000000000000000000000000695a122b5e936f82719217c4823025bff07b4d51"),
					common.HexToHash("0x000000000000000000000000695a122b5e936f82719217c4823025bff07b4d51"),
				},
				Data: hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffb746104a3e2f947dfe4900000000000000000000000000000000000000000000001b0d88b0e03faeaa110000000000000000000000000000000000000000201f03bbdfb9eeaa39b2be67000000000000000000000000000000000000000000169e8c5e068dbeecfd0694ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff5dd40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003a81c4e7fdc86c"),
			},
		},
		// tx4
		{
			{
				Address: common.HexToAddress("0xcF59B8C8BAA2dea520e3D549F97d4e49aDE17057"),
				Topics: []common.Hash{
					common.HexToHash("0x19b47279256b2a23a1665c810c8d55a1758940ee09377d4f8d26497a3577dc83"),
					common.HexToHash("0x000000000000000000000000695a122b5e936f82719217c4823025bff07b4d51"),
					common.HexToHash("0x000000000000000000000000695a122b5e936f82719217c4823025bff07b4d51"),
				},
				Data: hexutil.MustDecode("0xfffffffffffffffffffffffffffffffffffffffffffff949fea54034d018f33900000000000000000000000000000000000000000000001b0d88b0e03faeaa110000000000000000000000000000000000000000201fb01f52e928503fcc55ce0000000000000000000000000000000000000000004dd7131578ce1d99162e57ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff5dd60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003a81c4e7fdc914"),
			},
		},
	}

	testCase6DODO = [][]*types.Log{
		// tx1
		{
			{
				Address: common.HexToAddress("0x47423Dbe87f337A4a5c17Cc57d09B971d501DD14"),
				Topics: []common.Hash{
					common.HexToHash("0xc2c0245e056d5fb095f04cd6373bc770802ebd1e6c918eb78fdef843cdb37b0f"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d00000000000000000000000055d398326f99059ff775485246999027b31979550000000000000000000000000000000000000000000005884678fede0dd416b10000000000000000000000000000000000000000000005875c290aca3bfc4a7f00000000000000000000000042a7898c2cbfd351603551ff626c6493e4fef75100000000000000000000000042a7898c2cbfd351603551ff626c6493e4fef751"),
			},
		},
		// tx2
		{
			{
				Address: common.HexToAddress("0x47423Dbe87f337A4a5c17Cc57d09B971d501DD14"),
				Topics: []common.Hash{
					common.HexToHash("0xc2c0245e056d5fb095f04cd6373bc770802ebd1e6c918eb78fdef843cdb37b0f"),
				},
				Data: hexutil.MustDecode("0x0000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d00000000000000000000000055d398326f99059ff775485246999027b31979550000000000000000000000000000000000000000000001e239086fb266dbd0000000000000000000000000000000000000000000000001dfc3e5c4d000738b970000000000000000000000004a99693dbc7545efc4b39431f163adcb4ed541fb0000000000000000000000004a99693dbc7545efc4b39431f163adcb4ed541fb"),
			},
		},
		// tx3
		{
			{
				Address: common.HexToAddress("0x47423Dbe87f337A4a5c17Cc57d09B971d501DD14"),
				Topics: []common.Hash{
					common.HexToHash("0xc2c0245e056d5fb095f04cd6373bc770802ebd1e6c918eb78fdef843cdb37b0f"),
				},
				Data: hexutil.MustDecode("0x00000000000000000000000055d398326f99059ff775485246999027b31979550000000000000000000000008ac76a51cc950d9822d68b83fe1ad97b32cd580d0000000000000000000000000000000000000000000005875c290aca3bfc4a7f00000000000000000000000000000000000000000000058a746dece7b6fba04a000000000000000000000000946d7590da72429897a765972ad7922e7040483d000000000000000000000000946d7590da72429897a765972ad7922e7040483d"),
			},
		},
	}
)
